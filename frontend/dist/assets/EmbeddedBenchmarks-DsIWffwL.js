import{u as S,j as e}from"./vendor-query-Bq4hz6H9.js";import{r as k}from"./vendor-router-CdtyvhQv.js";import{a as B,g as A}from"./index-B6-oWjXE.js";import{P as h,C as i,a as s,l as C,T as n,B as _,L as l,h as p,o as M,t as d,D as w,f as P}from"./vendor-polaris-1WqYVNpP.js";import"./vendor-react-N--QU9DW.js";import"./vendor-sentry-UzNpYtBG.js";import"./vendor-appbridge-DL6abzKC.js";async function T(o){const c=await B(`${A()}/benchmarks/report`,o);if(!c.ok)throw new Error("Failed to fetch benchmarks");return c.json()}function $({shop:o}){const[c,g]=k.useState(""),{data:t,isLoading:m,error:b,refetch:v}=S({queryKey:["benchmarks",o,c],queryFn:()=>T(o),enabled:!!o}),y=a=>{const r={"A+":"success",A:"success","B+":"info",B:"info","C+":"attention",C:"attention",D:"warning",F:"critical"};return e.jsx(d,{tone:r[a]||void 0,size:"large",children:a})};if(m)return e.jsx(h,{title:"Benchmarks",children:e.jsx(i,{children:e.jsxs(s,{gap:"200",inlineAlign:"center",children:[e.jsx(C,{size:"large"}),e.jsx(n,{as:"p",children:"Analyzing your performance..."})]})})});if(b)return e.jsx(h,{title:"Benchmarks",children:e.jsx(_,{tone:"critical",children:"Failed to load benchmarks. Please try again."})});const f=t?.metrics||{},u=t?.strengths||[],x=t?.opportunities||[],j=t?.recommendations||[];return e.jsx(h,{title:"Benchmarks",subtitle:"See how your loyalty program compares to similar stores",secondaryActions:[{content:"Refresh",onAction:()=>v()}],children:e.jsxs(l,{children:[e.jsx(l.Section,{children:e.jsx(i,{children:e.jsxs(s,{gap:"400",children:[e.jsxs(p,{align:"space-between",children:[e.jsxs(s,{gap:"200",children:[e.jsx(n,{as:"h2",variant:"headingLg",children:"Overall Performance"}),e.jsx(n,{as:"p",variant:"bodyMd",tone:"subdued",children:"Based on all available metrics"})]}),e.jsxs(s,{gap:"200",inlineAlign:"end",children:[t?.overall_grade&&y(t.overall_grade),t?.overall_score!=null&&e.jsxs(n,{as:"p",variant:"bodySm",tone:"subdued",children:[t.overall_score.toFixed(0),"th percentile"]})]})]}),t?.overall_score!=null&&e.jsx(M,{progress:t.overall_score,tone:t.overall_score>=50?"primary":"critical",size:"small"})]})})}),e.jsx(l.Section,{variant:"oneHalf",children:e.jsx(i,{children:e.jsxs(s,{gap:"300",children:[e.jsx(n,{as:"h3",variant:"headingMd",children:"Your Strengths"}),u.length===0?e.jsx(n,{as:"p",tone:"subdued",children:"Keep building your program to unlock strengths!"}):e.jsx(s,{gap:"200",children:u.map((a,r)=>e.jsxs(p,{gap:"200",align:"start",children:[e.jsx(d,{tone:"success",children:`${a.percentile}%`}),e.jsx(n,{as:"p",children:a.message})]},r))})]})})}),e.jsx(l.Section,{variant:"oneHalf",children:e.jsx(i,{children:e.jsxs(s,{gap:"300",children:[e.jsx(n,{as:"h3",variant:"headingMd",children:"Opportunities"}),x.length===0?e.jsx(n,{as:"p",tone:"subdued",children:"Great job! No major opportunities identified."}):e.jsx(s,{gap:"200",children:x.map((a,r)=>e.jsxs(s,{gap:"100",children:[e.jsxs(p,{gap:"200",children:[e.jsx(d,{tone:"attention",children:`${a.percentile}%`}),e.jsx(n,{as:"p",fontWeight:"semibold",children:a.metric})]}),e.jsx(n,{as:"p",tone:"subdued",variant:"bodySm",children:a.recommendation})]},r))})]})})}),e.jsx(l.Section,{children:e.jsx(i,{children:e.jsxs(s,{gap:"300",children:[e.jsx(n,{as:"h3",variant:"headingMd",children:"All Metrics"}),e.jsx(w,{columnContentTypes:["text","numeric","numeric","text"],headings:["Metric","Your Value","Industry Median","Percentile"],rows:Object.entries(f).map(([a,r])=>[r.name,r.your_value!==null?r.your_value.toLocaleString():"N/A",r.p50?.toLocaleString()||"N/A",r.percentile!==null?e.jsx(d,{tone:r.percentile>=50?"success":"attention",children:`${r.percentile}%`}):"N/A"])})]})})}),j.length>0&&e.jsx(l.Section,{children:e.jsx(i,{children:e.jsxs(s,{gap:"300",children:[e.jsx(n,{as:"h3",variant:"headingMd",children:"Recommendations"}),e.jsx(s,{gap:"200",children:j.map((a,r)=>e.jsx(i,{children:e.jsx(n,{as:"p",children:a})},r))})]})})}),e.jsx(l.Section,{variant:"oneThird",children:e.jsx(i,{children:e.jsxs(s,{gap:"300",children:[e.jsx(n,{as:"h3",variant:"headingMd",children:"Industry Comparison"}),e.jsx(P,{label:"Compare against",options:[{label:"All Stores",value:""},{label:"Sports Cards",value:"sports_cards"},{label:"Pokemon TCG",value:"pokemon"},{label:"Magic: The Gathering",value:"mtg"},{label:"Collectibles",value:"collectibles"},{label:"General Retail",value:"general_retail"}],value:c,onChange:g}),e.jsx(n,{as:"p",variant:"bodySm",tone:"subdued",children:"Narrow down benchmarks to stores in your industry for more relevant comparisons."})]})})})]})})}export{$ as EmbeddedBenchmarks,$ as default};

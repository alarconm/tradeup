import{b as T,u as C,c as I,j as e}from"./vendor-query-Bq4hz6H9.js";import{u as A,r as B}from"./vendor-router-CdtyvhQv.js";import{a as S,g as v}from"./index-CIr4Wx79.js";import{P as y,L as h,C as g,a,b as f,aa as w,h as o,T as i,t as x,B as D,c as u,I as E,r as k,s as M,z as O,Y as p}from"./vendor-polaris-vFYxDTRx.js";import"./vendor-react-N--QU9DW.js";import"./vendor-sentry-UzNpYtBG.js";import"./vendor-appbridge-DL6abzKC.js";async function z(t){const n=await S(`${v()}/setup/theme-blocks/status`,t);if(!n.ok)throw new Error("Failed to fetch theme blocks status");return n.json()}async function P(t,n){if(!(await S(`${v()}/setup/theme-blocks/${n}/mark-installed`,t,{method:"POST"})).ok)throw new Error("Failed to mark block as installed")}const N={"membership-signup":{fullDescription:"A call-to-action block that encourages visitors to join your loyalty program. Shows membership benefits and a signup button.",benefits:["Increase membership signups","Highlight program benefits","Customizable design to match your theme"],installSteps:["Go to Online Store > Themes > Customize","Navigate to the page where you want the block",'Click "Add section" or "Add block"','Search for "TradeUp" and select "Membership Signup"',"Position and customize as needed","Save your changes"],previewDescription:'Shows a card with membership benefits and a "Join Now" button'},"credit-badge":{fullDescription:"Displays the customer's current store credit balance. Great for headers or account pages to remind customers of their available credit.",benefits:["Encourage credit redemption","Build customer loyalty","Reduce support inquiries about balance"],installSteps:["Go to Online Store > Themes > Customize","Click on your header section",'Add the "TradeUp Credit Badge" block',"Position it near your cart icon","Save your changes"],previewDescription:'Shows a small badge with credit amount (e.g., "$25.00 Credit")'},"trade-in-cta":{fullDescription:"A prominent button that links to your trade-in submission form. Encourages customers to trade in their items.",benefits:["Drive trade-in submissions","Increase customer engagement","Promote circular economy"],installSteps:["Go to Online Store > Themes > Customize","Navigate to your homepage or collection pages",'Add the "TradeUp Trade-In CTA" block',"Customize the button text and style","Save your changes"],previewDescription:'Shows a button like "Trade In Your Items" with optional icon'},"refer-friend":{fullDescription:"Enables your referral program by showing customers how to invite friends and earn rewards.",benefits:["Grow through word-of-mouth","Reward loyal customers","Track referral success"],installSteps:["Go to Online Store > Themes > Customize","Navigate to your account page or thank you page",'Add the "TradeUp Refer a Friend" block',"Configure referral rewards if needed","Save your changes"],previewDescription:"Shows referral link and reward info for customers"}};function H({shop:t}){const n=A(),c=T(),[m,b]=B.useState(null),{data:l,isLoading:j}=C({queryKey:["theme-blocks-status",t],queryFn:()=>z(t),enabled:!!t}),r=I({mutationFn:s=>P(t,s),onSuccess:()=>{c.invalidateQueries({queryKey:["theme-blocks-status",t]}),c.invalidateQueries({queryKey:["setup-status",t]})}}),d=()=>{const s=t?.replace(".myshopify.com","")||"";window.open(`https://admin.shopify.com/store/${s}/themes/current/editor`,"_blank")};return j?e.jsx(y,{title:"Theme Blocks",backAction:{content:"Dashboard",onAction:()=>n("/app")},children:e.jsx(h,{children:e.jsx(h.Section,{children:e.jsx(g,{children:e.jsx(a,{gap:"400",children:e.jsx(f,{background:"bg-surface-secondary",borderRadius:"100",minHeight:"200px"})})})})})}):e.jsx(y,{title:"Theme Blocks",subtitle:"Add TradeUp blocks to your storefront to maximize engagement",backAction:{content:"Dashboard",onAction:()=>n("/app")},primaryAction:{content:"Open Theme Editor",icon:w,onAction:d},children:e.jsxs(h,{children:[e.jsx(h.Section,{children:e.jsx(g,{children:e.jsxs(a,{gap:"400",children:[e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(i,{as:"h2",variant:"headingMd",children:"Installation Progress"}),e.jsxs(i,{as:"p",variant:"bodySm",tone:"subdued",children:[l?.installed_count||0," of ",l?.total_count||4," blocks installed"]})]}),l?.all_installed&&e.jsx(x,{tone:"success",children:"All Installed"})]}),!l?.all_installed&&e.jsx(D,{tone:"info",children:e.jsx("p",{children:"Theme blocks help customers discover your loyalty program. Install at least one block to complete your setup."})})]})})}),l?.blocks.map(s=>e.jsx(h.Section,{children:e.jsx(_,{block:s,details:N[s.id],expanded:m===s.id,onToggle:()=>b(m===s.id?null:s.id),onMarkInstalled:()=>r.mutate(s.id),onOpenEditor:d,isMarking:r.isPending})},s.id)),e.jsx(h.Section,{children:e.jsx(g,{children:e.jsxs(a,{gap:"400",children:[e.jsx(i,{as:"h3",variant:"headingMd",children:"Need Help?"}),e.jsx(i,{as:"p",variant:"bodyMd",tone:"subdued",children:"If you're having trouble installing theme blocks, check out our documentation or contact support."}),e.jsxs(o,{gap:"300",children:[e.jsx(u,{url:"https://help.cardflowlabs.com/theme-blocks",external:!0,children:"View Documentation"}),e.jsx(u,{variant:"plain",url:"mailto:mike@orbsportscards.com",children:"Contact Support"})]})]})})})]})})}function _({block:t,details:n,expanded:c,onToggle:m,onMarkInstalled:b,onOpenEditor:l,isMarking:j}){return e.jsx(g,{children:e.jsxs(a,{gap:"400",children:[e.jsxs(o,{align:"space-between",blockAlign:"start",children:[e.jsxs(o,{gap:"300",blockAlign:"center",children:[e.jsx(E,{source:t.installed?k:M,tone:t.installed?"success":"subdued"}),e.jsxs(a,{gap:"050",children:[e.jsx(i,{as:"h3",variant:"headingMd",children:t.name}),e.jsx(i,{as:"p",variant:"bodySm",tone:"subdued",children:t.description})]})]}),e.jsx(o,{gap:"200",children:t.installed?e.jsx(x,{tone:"success",children:"Installed"}):e.jsx(x,{children:"Not Installed"})})]}),e.jsxs(o,{gap:"200",children:[e.jsx(i,{as:"span",variant:"bodySm",fontWeight:"semibold",children:"Recommended for:"}),e.jsx(o,{gap:"100",children:t.recommended_pages.map(r=>e.jsx(x,{tone:"info",children:r},r))})]}),e.jsx(u,{variant:"plain",onClick:m,children:c?"Hide installation guide":"Show installation guide"}),c&&n&&e.jsxs(f,{paddingBlockStart:"200",children:[e.jsx(O,{}),e.jsx(f,{paddingBlockStart:"400",children:e.jsxs(a,{gap:"400",children:[e.jsxs(a,{gap:"200",children:[e.jsx(i,{as:"h4",variant:"headingSm",children:"About this block"}),e.jsx(i,{as:"p",variant:"bodyMd",children:n.fullDescription})]}),e.jsxs(a,{gap:"200",children:[e.jsx(i,{as:"h4",variant:"headingSm",children:"Benefits"}),e.jsx(p,{children:n.benefits.map((r,d)=>e.jsx(p.Item,{children:r},d))})]}),e.jsxs(a,{gap:"200",children:[e.jsx(i,{as:"h4",variant:"headingSm",children:"Installation Steps"}),e.jsx(p,{type:"number",children:n.installSteps.map((r,d)=>e.jsx(p.Item,{children:r},d))})]}),e.jsxs(o,{gap:"300",children:[e.jsx(u,{variant:"primary",icon:w,onClick:l,children:"Open Theme Editor"}),!t.installed&&e.jsx(u,{onClick:b,loading:j,icon:k,children:"Mark as Installed"})]})]})})]})]})})}export{H as EmbeddedThemeBlocks};

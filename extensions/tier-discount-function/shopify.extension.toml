# TradeUp Tier-Based Discount Function
# Automatically applies membership tier discounts at checkout
# https://shopify.dev/docs/api/functions/reference/order-discounts

api_version = "2025-01"

[[extensions]]
name = "TradeUp Tier Discounts"
handle = "tradeup-tier-discounts"
type = "function"

  [extensions.build]
  command = "npm exec -- shopify app function build"
  path = "dist/function.wasm"
  watch = ["src/**/*.js", "src/input.graphql"]

  [extensions.ui]
  enable_create = true

    [extensions.ui.paths]
    create = "/tier-discount/create"
    details = "/tier-discount/:id"

  [extensions.input.variables]
  namespace = "tradeup-tier-discount"
  key = "function-configuration"

  # Function targeting - Order Discount API
  [[extensions.targeting]]
  target = "purchase.order-discount.run"
  input_query = "src/input.graphql"
  export = "run"
